import{i as L,k as S,e as C,a as T,l as V,r as t,j as e,M as E,m as M}from"./index-BKzr11kV.js";const R=!1;function A(){const{token:o}=L(),[y]=S(),a=y.get("action")||"verify",n=C(),{toast:m}=T(),{resetPassword:w}=V(),[j,g]=t.useState(!0),[i,c]=t.useState(!1),[b,l]=t.useState(""),[D,W]=t.useState(""),[B,F]=t.useState(!1),[s,k]=t.useState(""),[d,N]=t.useState(""),[p,u]=t.useState(""),[x,v]=t.useState(!1);t.useEffect(()=>{(async()=>{if(!o){g(!1),l("Token no válido o expirado.");return}if(a==="reset"){g(!1);return}try{const f=await(await fetch(`/api/auth/verify/${o}`)).json();c(f.success),l(f.message),f.success&&(m({title:"Verificación exitosa",description:"Tu cuenta ha sido verificada correctamente. Ya puedes iniciar sesión."}),setTimeout(()=>{n("/")},3e3))}catch{c(!1),l("Error al verificar la cuenta. Por favor, intenta de nuevo.")}finally{g(!1)}})()},[o,a,n,m]);const P=async r=>{if(r.preventDefault(),!s){u("La contraseña es requerida");return}if(s.length<8){u("La contraseña debe tener al menos 8 caracteres");return}if(s!==d){u("Las contraseñas no coinciden");return}v(!0);try{await w(o||"",s),c(!0),l("Tu contraseña ha sido restablecida correctamente."),m({title:"Contraseña restablecida",description:"Tu contraseña ha sido cambiada correctamente. Ya puedes iniciar sesión con tu nueva contraseña."}),setTimeout(()=>{n("/")},3e3)}catch(h){c(!1),u(h.message||"Error al restablecer la contraseña. Por favor, intenta de nuevo.")}finally{v(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 flex flex-col items-center justify-center px-4 py-12",children:[e.jsx(E,{title:a==="verify"?"Verificación de cuenta":"Restablecer contraseña",description:a==="verify"?"Verifica tu cuenta para acceder a todas las funcionalidades":"Restablece tu contraseña para acceder a tu cuenta"}),R,e.jsx(M.div,{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:["TuWeb",e.jsx("span",{className:"text-blue-600",children:".ai"})]}),e.jsx("h2",{className:"text-xl font-medium text-gray-700 dark:text-gray-300",children:a==="verify"?"Verificación de cuenta":"Restablecer contraseña"})]}),j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Procesando tu solicitud..."})]}):e.jsx(e.Fragment,{children:a==="verify"?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`w-20 h-20 mx-auto rounded-full flex items-center justify-center ${i?"bg-green-100 dark:bg-green-900":"bg-red-100 dark:bg-red-900"}`,children:i?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:`text-lg font-medium mt-4 ${i?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:i?"Verificación exitosa":"Error de verificación"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:b}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>n("/"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Volver al inicio"})})]}):e.jsx(e.Fragment,{children:i?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 text-green-600 dark:text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-medium mt-4 text-green-600 dark:text-green-400",children:"Contraseña restablecida"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:b}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>n("/"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Volver al inicio"})})]}):e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nueva contraseña"}),e.jsx("input",{type:"password",id:"newPassword",value:s,onChange:r=>k(r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 dark:bg-gray-700 dark:text-white transition-all duration-200",placeholder:"********",disabled:x}),s&&s.length<8&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"La contraseña debe tener al menos 8 caracteres"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Confirmar contraseña"}),e.jsx("input",{type:"password",id:"confirmPassword",value:d,onChange:r=>N(r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 dark:bg-gray-700 dark:text-white transition-all duration-200",placeholder:"********",disabled:x}),d&&s!==d&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Las contraseñas no coinciden"})]}),p&&e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-lg text-sm",children:p}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors disabled:opacity-70 disabled:cursor-not-allowed",disabled:x,children:x?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Procesando..."]}):"Restablecer contraseña"})]})})})]})})]})}export{A as default};
